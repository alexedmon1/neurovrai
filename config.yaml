# MRI Preprocessing Pipeline Configuration
# Based on README.md specification

# Project paths
project_dir: /mnt/bytopia/IRC805
rawdata_dir: ${project_dir}/subjects  # IRC805 uses 'subjects' instead of 'rawdata'
derivatives_dir: ${project_dir}/derivatives
work_dir: ${project_dir}/work
transforms_dir: ${project_dir}/transforms

# Execution settings
execution:
  plugin: MultiProc
  n_procs: 6

# Template files
templates:
  mni152_t1_2mm: /usr/local/fsl/data/standard/MNI152_T1_2mm_brain.nii.gz
  mni152_t1_1mm: /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz

# Anatomical preprocessing
anatomical:
  bet:
    frac: 0.5
    reduce_bias: true
    robust: true
  segmentation_method: ants  # 'ants' (Atropos) or 'fsl' (FAST)
  atropos:
    n_iterations: 5
    convergence_threshold: 0.001
    mrf_smoothing_factor: 0.1
  registration_method: fsl  # or 'ants'
  run_qc: true

# Diffusion preprocessing
diffusion:
  denoise_method: dwidenoise
  topup:
    readout_time: 0.05
  eddy_config:
    flm: linear
    slm: linear
    use_cuda: true
  run_qc: true

# Functional preprocessing
functional:
  tr: 1.029
  te: [10.0, 30.0, 50.0]
  highpass: 0.001
  lowpass: 0.08
  fwhm: 6
  normalize_to_mni: true  # Reuse anatomical transforms for normalization
  tedana:
    enabled: true
    tedpca: kundu
    tree: kundu
  aroma:
    enabled: false  # Redundant with TEDANA
  acompcor:
    enabled: true
    num_components: 5
    variance_threshold: 0.5
  run_qc: true
